(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5599a0f8"],{"8a3f":function(e,t,s){},c27e:function(e,t,s){"use strict";var r=s("8a3f"),o=s.n(r);o.a},c641:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"search"},[s("Row",[s("Col",[s("Card",[s("Row",[s("Form",{ref:"searchForm",staticClass:"search-form",attrs:{model:e.searchForm,inline:"","label-width":70}},[s("Form-item",{attrs:{label:"用户名",prop:"username"}},[s("Input",{staticStyle:{width:"200px"},attrs:{type:"text",clearable:"",placeholder:"请输入用户名"},model:{value:e.searchForm.username,callback:function(t){e.$set(e.searchForm,"username",t)},expression:"searchForm.username"}})],1),s("Form-item",{attrs:{label:"手机号",prop:"mobile"}},[s("Input",{staticStyle:{width:"200px"},attrs:{type:"text",clearable:"",placeholder:"请输入手机号"},model:{value:e.searchForm.mobile,callback:function(t){e.$set(e.searchForm,"mobile",t)},expression:"searchForm.mobile"}})],1),s("Form-item",{attrs:{label:"用户状态",prop:"status"}},[s("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择状态",clearable:""},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},[s("Option",{attrs:{value:"0"}},[e._v("无效")]),s("Option",{attrs:{value:"1"}},[e._v("有效")])],1)],1),s("Form-item",{attrs:{label:"创建时间"}},[s("DatePicker",{staticStyle:{width:"200px"},attrs:{type:"daterange",format:"yyyy-MM-dd",clearable:"",placeholder:"选择起始时间"},on:{"on-change":e.selectDateRange},model:{value:e.selectDate,callback:function(t){e.selectDate=t},expression:"selectDate"}})],1),s("Form-item",{staticClass:"br",staticStyle:{"margin-left":"-35px"}},[s("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:e.handleSearch}},[e._v("搜索")]),s("Button",{on:{click:e.handleReset}},[e._v("重置")])],1)],1)],1),s("Row",{staticClass:"operation"},[s("Button",{directives:[{name:"has",rawName:"v-has",value:"add",expression:"'add'"}],attrs:{type:"primary",icon:"md-add"},on:{click:e.add}},[e._v("新增用户")]),s("Button",{directives:[{name:"has",rawName:"v-has",value:"delete",expression:"'delete'"}],attrs:{icon:"md-trash"},on:{click:e.delAll}},[e._v("批量删除")]),s("Dropdown",{on:{"on-click":e.handleDropdown}},[s("Button",[e._v("\n                            更多操作\n                            "),s("Icon",{attrs:{type:"md-arrow-dropdown"}})],1),s("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[s("DropdownItem",{attrs:{name:"refresh"}},[e._v("刷新")]),s("DropdownItem",{attrs:{name:"exportData"}},[e._v("导出所选数据")]),s("DropdownItem",{attrs:{name:"exportDataAll"}},[e._v("导出全部数据")])],1)],1),s("Dropdown",{staticStyle:{float:"right"},on:{"on-click":e.handleDropdown}},[s("Button",[e._v("\n                            设置显示列\n                            "),s("Icon",{attrs:{type:"md-arrow-dropdown"}})],1),s("DropdownMenu",{staticStyle:{padding:"10px"},attrs:{slot:"list"},slot:"list"},[s("Checkbox-group",{on:{"on-change":e.changeTableColumns},model:{value:e.tableColumnsChecked,callback:function(t){e.tableColumnsChecked=t},expression:"tableColumnsChecked"}},e._l(e.allColumns,(function(t){return s("Checkbox",{key:t.key,attrs:{label:t.key}},[e._v(e._s(t.title))])})),1)],1)],1)],1),s("Row",[s("Alert",{attrs:{"show-icon":""}},[e._v("\n                        已选择 "),s("span",{staticClass:"select-count"},[e._v(e._s(e.selectCount))]),e._v(" 项\n                        "),s("a",{staticClass:"select-clear",on:{click:e.clearSelectAll}},[e._v("清空")])])],1),s("Row",[s("Table",{ref:"table",attrs:{loading:e.loading,border:"",columns:e.columns,data:e.data,sortable:"custom"},on:{"on-sort-change":e.changeSort,"on-selection-change":e.showSelect}}),s("Table",{ref:"exportTable",staticStyle:{display:"none"},attrs:{columns:e.columns,data:e.exportData}})],1),s("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[s("Page",{attrs:{current:e.searchForm.pageNumber,total:e.total,"page-size":e.searchForm.pageSize,"page-size-opts":[10,20,50],size:"small","show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":e.changePage,"on-page-size-change":e.changePageSize}})],1)],1)],1)],1),s("Modal",{attrs:{title:e.modalTitle,"mask-closable":!1,width:500,styles:{top:"30px"}},model:{value:e.userModalVisible,callback:function(t){e.userModalVisible=t},expression:"userModalVisible"}},[s("Form",{ref:"userForm",attrs:{model:e.userForm,"label-width":70,rules:e.userFormValidate}},[s("FormItem",{attrs:{label:"用户名",prop:"username"}},[s("Input",{attrs:{autocomplete:"off"},model:{value:e.userForm.username,callback:function(t){e.$set(e.userForm,"username",t)},expression:"userForm.username"}})],1),0===e.modalType?s("FormItem",{attrs:{label:"密码",prop:"password",error:e.errorPass}},[s("Input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.userForm.password,callback:function(t){e.$set(e.userForm,"password",t)},expression:"userForm.password"}})],1):e._e(),s("FormItem",{attrs:{label:"邮箱",prop:"email"}},[s("Input",{model:{value:e.userForm.email,callback:function(t){e.$set(e.userForm,"email",t)},expression:"userForm.email"}})],1),s("FormItem",{attrs:{label:"手机号",prop:"mobile"}},[s("Input",{model:{value:e.userForm.mobile,callback:function(t){e.$set(e.userForm,"mobile",t)},expression:"userForm.mobile"}})],1)],1),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("Button",{attrs:{type:"text"},on:{click:e.cancelUser}},[e._v("取消")]),s("Button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:e.submitUser}},[e._v("提交")])],1)],1),s("Modal",{attrs:{title:e.passwordModalTitle,"mask-closable":!1,width:500,styles:{top:"30px"}},model:{value:e.passwordModalVisible,callback:function(t){e.passwordModalVisible=t},expression:"passwordModalVisible"}},[s("Form",{ref:"passwordForm",attrs:{model:e.passwordForm,"label-width":70,rules:e.passwordFormValidate}},[s("FormItem",{attrs:{label:"密码",prop:"password",error:e.errorPass}},[s("Input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.passwordForm.password,callback:function(t){e.$set(e.passwordForm,"password",t)},expression:"passwordForm.password"}})],1),s("FormItem",{attrs:{label:"确认密码",prop:"confirmPassword",error:e.errorPass}},[s("Input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.passwordForm.confirmPassword,callback:function(t){e.$set(e.passwordForm,"confirmPassword",t)},expression:"passwordForm.confirmPassword"}})],1),s("input",{directives:[{name:"model",rawName:"v-model",value:e.passwordForm.id,expression:"passwordForm.id"}],attrs:{type:"hidden"},domProps:{value:e.passwordForm.id},on:{input:function(t){t.target.composing||e.$set(e.passwordForm,"id",t.target.value)}}})],1),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("Button",{attrs:{type:"text"},on:{click:e.cancelPassword}},[e._v("取消")]),s("Button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:e.submitPassword}},[e._v("提交")])],1)],1)],1)},o=[],a=(s("ed63"),s("8cf2"),s("6d57"),s("365c")),n=s("23d5"),i=s.n(n),l={name:"userInfo-manage",data:function(){var e=this,t=function(e,t,s){var r=/(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])[A-Za-z0-9]/;!r.test(t)||t.length<6||t.length>16?s(new Error("密码必须6-16位大小写字母和数字组合")):s()},s=function(t,s,r){""==s?r(new Error("确认密码不能为空")):e.passwordForm.password!=s?r(new Error("确认密码错误")):r()},r=function(e,t,s){var r=/^[1][3,4,5,7,8][0-9]{9}$/;r.test(t)?s():s(new Error("手机号格式错误"))};return{accessToken:{},loading:!0,drop:!1,dropDownContent:"展开",dropDownIcon:"ios-arrow-down",selectCount:0,imageDomain:"",selectList:[],category:[],selectDep:[],permTypes:[],tableColumnsChecked:["username","mobile","email","status","createdAt"],searchForm:{username:"",mobile:"",status:null,startDate:"",endDate:""},errorPass:"",submitLoading:!1,userForm:{username:"",email:"",mobile:"",password:""},passwordForm:{password:"",confirmPassword:"",id:0},userFormValidate:{username:[{required:!0,message:"账号不能为空",trigger:"blur"}],mobile:[{required:!0,message:"手机号不能为空",trigger:"blur"},{validator:r,trigger:"blur"}],email:[{required:!0,message:"请输入邮箱地址"},{type:"email",message:"邮箱格式不正确"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"},{validator:t,trigger:"blur"}]},passwordFormValidate:{password:[{required:!0,message:"密码不能为空",trigger:"blur"},{validator:t,trigger:"blur"}],confirmPassword:[{validator:s,trigger:"blur"}]},userModalVisible:!1,passwordModalVisible:!1,modalTitle:"",passwordModalTitle:"修改密码",selectDate:null,modalType:0,columns:[],allColumns:[{title:"用户名",key:"username",sortable:!0,align:"center"},{title:"手机号",key:"mobile",sortable:!0,align:"center"},{title:"邮箱",key:"email",sortable:!0,align:"center",render:function(e,t){return e("div",t.row.email?t.row.email:"-")}},{title:"状态",key:"status",align:"center",width:140,render:function(e,t){return 1===t.row.status?e("div",[e("Tag",{props:{type:"dot",color:"success"}},"正常启用")]):0===t.row.status?e("div",[e("Tag",{props:{type:"dot",color:"error"}},"禁用")]):void 0},filters:[{label:"正常启用",value:1},{label:"禁用",value:0}],filterMultiple:!1,filterMethod:function(e,t){return 1===e?1===t.status:0===e?0===t.status:void 0}},{title:"创建时间",key:"createdAt",sortable:!0,sortType:"desc",render:function(e,t){return e("div",i()(1e3*t.row.createdAt).format("YYYY-MM-DD HH:mm:ss"))}}],data:[],exportData:[],total:0}},methods:{init:function(){this.accessToken={accessToken:this.getStore("accessToken")},this.changeTableColumns(),this.$refs.ueditor={},this.initMeta(),this.getUserInfoList()},initMeta:function(){var e=this.$route.meta.permTypes;null!==e&&void 0!==e&&(this.permTypes=e)},changePage:function(e){this.searchForm.pageNumber=e,this.getUserInfoList(),this.clearSelectAll()},changePageSize:function(e){this.searchForm.pageSize=e,this.getUserInfoList()},selectDateRange:function(e){e&&(this.searchForm.startDate=e[0],this.searchForm.endDate=e[1])},getUserInfoList:function(){var e=this;this.selectCount=0,this.loading=!0,Object(a["T"])(this.searchForm).then((function(t){e.loading=!1,!0===t.success&&(e.data=t.result.records,e.total=t.result.total)}))},handleSearch:function(){this.searchForm.pageNumber=1,this.searchForm.pageSize=10,this.getUserInfoList()},handleSearchExportAll:function(){var e=this,t=JSON.stringify(this.searchForm),s=JSON.parse(t);s.pageNumber=1,s.pageSize=1e9,Object(a["T"])(s).then((function(t){!0===t.success&&(e.exportData=t.result.records)}))},handleReset:function(){this.$refs.searchForm.resetFields(),this.searchForm.pageNumber=1,this.searchForm.pageSize=10,this.selectDate=null,this.searchForm.startDate="",this.searchForm.endDate="",this.searchForm.categoryId="",this.getUserInfoList()},changeSort:function(e){this.searchForm.sort=e.key,this.searchForm.order=e.order,"normal"===e.order&&(this.searchForm.order=""),this.getUserInfoList()},handleDropdown:function(e){var t=this;if("exportData"===e){if(this.selectCount<=0)return void this.$Message.warning("您还未选择要导出的数据");this.$Modal.confirm({title:"确认导出",content:"您确认要导出所选 "+this.selectCount+" 条数据?",onOk:function(){t.$refs.exportTable.exportCsv({filename:"用户数据",columns:t.allColumns,data:t.exportData.map((function(e){return e.createdAt=i()(1e3*e.createdAt).format("YYYY-MM-DD HH:mm:ss"),0===e.status?e.status="禁用":1===e.status&&(e.status="启用"),e}))})}})}else"exportDataAll"===e?(this.handleSearchExportAll(),this.$Modal.confirm({title:"确认导出",content:"您确认要导出全部数据?",onOk:function(){t.exportData.length<=0?t.$Message.warning("没有数据需要导出"):t.$refs.exportTable.exportCsv({filename:"文章数据",columns:t.allColumns,data:t.exportData.map((function(e){return e.createdAt=i()(1e3*e.createdAt).format("YYYY-MM-DD HH:mm:ss"),0===e.status?e.status="禁用":1===e.status&&(e.status="启用"),e}))})}})):"refresh"===e&&this.getUserInfoList()},cancelUser:function(){this.userModalVisible=!1},cancelPassword:function(){this.passwordModalVisible=!1},submitUser:function(){var e=this;this.$refs.userForm.validate((function(t){if(t)if(0===e.modalType){if(delete e.userForm.id,delete e.userForm.status,""==e.userForm.password||void 0==e.userForm.password)return void(e.errorPass="密码不能为空");if(e.userForm.password.length<6)return void(e.errorPass="密码长度不得少于6位");e.submitLoading=!0,Object(a["h"])(e.userForm).then((function(t){e.submitLoading=!1,!0===t.success&&(e.$Message.success("操作成功"),e.getUserInfoList(),e.userModalVisible=!1)}))}else Object(a["E"])(e.userForm).then((function(t){e.submitLoading=!1,!0===t.success&&(e.$Message.success("操作成功"),e.getUserInfoList(),e.userModalVisible=!1)}))}))},submitPassword:function(){var e=this;this.$refs.passwordForm.validate((function(t){t&&Object(a["gb"])(e.passwordForm).then((function(t){e.submitLoading=!1,!0===t.success&&(e.$Message.success("操作成功"),e.getUserInfoList(),e.passwordModalVisible=!1)}))}))},add:function(){this.modalType=0,this.modalTitle="添加用户",this.$refs.userForm.resetFields(),this.userModalVisible=!0},edit:function(e){for(var t in this.modalType=1,this.modalTitle="编辑用户",this.$refs.userForm.resetFields(),e)null===e[t]&&(e[t]="");var s=JSON.stringify(e),r=JSON.parse(s);this.userForm=r,this.userModalVisible=!0},enable:function(e){var t=this;this.$Modal.confirm({title:"确认启用",content:"您确认要启用用户 "+e.username+" ?",onOk:function(){Object(a["H"])(e.id).then((function(e){!0===e.success&&(t.$Message.success("操作成功"),t.getUserInfoList())}))}})},disable:function(e){var t=this;this.$Modal.confirm({title:"确认禁用",content:"您确认要禁用用户 "+e.username+" ?",onOk:function(){Object(a["v"])(e.id).then((function(e){!0===e.success&&(t.$Message.success("操作成功"),t.getUserInfoList())}))}})},remove:function(e){var t=this;this.$Modal.confirm({title:"确认删除",content:"您确认要删除用户 "+e.username+" ?",onOk:function(){Object(a["s"])(e.id).then((function(e){!0===e.success&&(t.$Message.success("删除成功"),t.getUserInfoList())}))}})},updatePassword:function(e){this.$refs.passwordForm.resetFields(),this.passwordForm.id=e.id,this.passwordModalVisible=!0},dropDown:function(){this.drop?(this.dropDownContent="展开",this.dropDownIcon="ios-arrow-down"):(this.dropDownContent="收起",this.dropDownIcon="ios-arrow-up"),this.drop=!this.drop},showSelect:function(e){this.exportData=e,this.selectList=e,this.selectCount=e.length},clearSelectAll:function(){this.$refs.table.selectAll(!1)},delAll:function(){var e=this;this.selectCount<=0?this.$Message.warning("您还未选择要删除的数据"):this.$Modal.confirm({title:"确认删除",content:"您确认要删除所选的 "+this.selectCount+" 条数据?",onOk:function(){var t="";e.selectList.forEach((function(e){t+=e.id+","})),t=t.substring(0,t.length-1),Object(a["s"])(t).then((function(t){!0===t.success&&(e.$Message.success("删除成功"),e.clearSelectAll(),e.getUserInfoList())}))}})},changeTableColumns:function(){this.columns=this.getTableColumns()},getTableColumns:function(){var e=this,t=[],s={type:"selection",align:"center",fixed:"left"};t.push(s);var r={title:"操作",key:"action",align:"center",fixed:"right",render:function(t,s){var r,o,a,n,i;return e.permTypes.includes("edit")&&(r=t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.edit(s.row)}}},"编辑")),e.permTypes.includes("enable")&&(a=t("Button",{props:{type:"success",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.enable(s.row)}}},"启用")),e.permTypes.includes("disable")&&(o=t("Button",{props:{size:"small"},style:{marginRight:"5px"},on:{click:function(){e.disable(s.row)}}},"禁用")),e.permTypes.includes("delete")&&(n=t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.remove(s.row)}}},"删除")),e.permTypes.includes("updatePassword")&&(i=t("Button",{props:{type:"warning",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.updatePassword(s.row)}}},"修改密码")),1===s.row.status?t("div",[r,o,i,n]):t("div",[r,a,i,n])}},o=this;return this.allColumns.forEach((function(e){o.tableColumnsChecked.forEach((function(s){e.key===s&&t.push(e)}))})),t.push(r),t}},mounted:function(){this.init()}},c=l,u=(s("c27e"),s("e90a")),d=Object(u["a"])(c,r,o,!1,null,null,null);t["default"]=d.exports}}]);